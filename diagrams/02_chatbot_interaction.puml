@startuml Chatbot Interaction Flow
!theme plain
title Chatbot Interaction (Text/Voice) Flow (FR10-FR17)

start

:User initiates chat;

fork
    :User types text query;
fork again
    :User records voice input;
    :System processes voice through ASR;
    :Convert speech to text;
end fork

:System receives query;

:System processes input;

:Classify query type;

if (Query type?) then (Spatial/GIS)
    :Call Map module;
    :Process spatial data;
    :Generate map response;
else (Non-spatial)
    :Call OpenAI API;
    :Process with AI model;
    :Generate text response;
endif

:System responds to user;

:Display response in chat;

:Store chat in history;

:User reviews response;

if (User satisfied?) then (yes)
    :End conversation;
    note right
        Optional: Export chat
    end note
else (no)
    :User continues conversation;
    :User sends follow-up query;
    :System processes input;
endif

stop
@enduml
